<!DOCTYPE html>
<html>
    <header>
        <title>Home Essential Product</title>
        <link rel="stylesheet" href="cart1.css">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </header>

<body>
    
    <div class="container">
        <h1>Shopping Cart</h1>
        <p>Select the item which you want to order.</p>
        <p>Click 'Empty Cart' button to remove session cookies from browser.</p>
        <div id="alerts"></div>
        <div class="productcont">
            <div class="product">
                <img src="https://images-na.ssl-images-amazon.com/images/I/71ZqzwANHLL._SX522_.jpg" alt="" width="150" height="150">
                <h3 class="productname">Godrej Ezee 2in1 Liquid Detergent + Fabric Conditioner</h3>
                <p>Godrej Ezee 2in1 Liquid Detergent + Fabric Conditioner - 500g</p>
                <p class="price">Rs 120</p>
                <button class="addtocart">Add To Cart</button>
            </div>
            <div class="product">
                <img src="https://m.media-amazon.com/images/I/71D39wQFWTL._AC_SS450_.jpg" alt="" width="150" height="150">
                <h3 class="productname">All Out All Night Spray</h3>
                <p>All Out All Night Spray, 30 ml</p>
                <p class="price">Rs 199</p>
                <button class="addtocart">Add To Cart</button>
            </div>
            <div class="product">
                <img src="https://images-na.ssl-images-amazon.com/images/I/61i7YbdTq2L._SL1500_.jpg" alt="" width="100" height="150">
                <h3 class="productname">Hit Lime Fresh Mosquito and Fly Killer Spray</h3>
                <p>Hit Lime Fresh Mosquito and Fly Killer Spray, 200 ml</p>
                <p class="price">Rs 99</p>
                <button class="addtocart">Add To Cart</button>
            </div>
        </div>
        <div class="productcont">
            <div class="product">
                <img src="https://images-na.ssl-images-amazon.com/images/I/71kRhPxl7PL._SL1500_.jpg" alt="" width="150" height="150">
                <h3 class="productname">Fruits & Vegetables Washing Liquid</h3>
                <p>Fruits & Vegetables Washing Liquid, Removes Germs, Bacteria, Chemicals & Waxes, 200 Ml</p>
                <p class="price">Rs 69</p>
                <button class="addtocart">Add To Cart</button>
            </div>
            <div class="product">
                <img src="https://res.sastasundar.com/incom/images/product/Godrej-aer-power-pocket-Bathroom-Fragrance-Berry-Rush-1614161505-10082961-1.jpg" alt="" width="150" height="150">
                <h3 class="productname">Godrej Aer Power Pocket</h3>
                <p>Godrej Aer Power Pocket Berry Rush Bathroom Fragrance, 10 gm</p>
                <p class="price">Rs 55</p>
                <button class="addtocart">Add To Cart</button>
            </div>
            <div class="product">
                <img src="https://images-na.ssl-images-amazon.com/images/I/61OsmApmxwL._SX466_.jpg" alt="" width="100" height="150">
                <h3 class="productname">Good Knight Fabric Roll On</h3>
                <p>Good Knight Fabric Roll On Bubblegum Fragrance Mosquito Repellent, 8 ml</p>
                <p class="price">Rs 75</p>
                <button class="addtocart">Add To Cart</button>
            </div>
        </div>

        <div class="productcont">
            <div class="product">
                <img src="https://newassets.apollo247.com/pub/media/catalog/product/l/i/lif0332_1.jpg" alt="" width="150" height="150">
                <h3 class="productname">Lifebuoy Germ Kill Spray</h3>
                <p>Lifebuoy Germ Kill Spray, 200 ml</p>
                <p class="price">Rs 199</p>
                <button class="addtocart">Add To Cart</button>
            </div>
            <div class="product">
                <img src="https://www.bigbasket.com/media/uploads/p/xxl/149353_10-hit-mosquito-fly-killer-spray.jpg" alt="" width="150" height="150">
                <h3 class="productname">HIT Mosquito and Fly Killer Spray</h3>
                <p>HIT Mosquito and Fly Killer Spray, 200ml</p>
                <p class="price">Rs 99</p>
                <button class="addtocart">Add To Cart</button>
            </div>
            <div class="product">
                <img src="https://n2.sdlcdn.com/imgs/e/p/j/Harpic-Power-Toilet-Cleaner-500-SDL354721838-1-1543b.jpg" alt="" width="150" height="150">
                <h3 class="productname">Harpic Power Plus Original Disinfectant Toilet Cleaner</h3>
                <p>Harpic Power Plus Original Disinfectant Toilet Cleaner, 500 ml</p>
                <p class="price">Rs 89</p>
                <button class="addtocart">Add To Cart</button>
            </div>
        </div>


        <div class="productcont">
            <div class="product">
                <img src="https://cdn01.pharmeasy.in/dam/products_otc/V19530/lizol-power-all-purpose-disinfectant-liquid-bottle-of-450-ml-2-1613733603.jpg" alt="" width="150" height="150">
                <h3 class="productname">Lizol Power All Purpose Disinfectant Liquid</h3>
                <p>Lizol Power All Purpose Disinfectant Liquid Bottle Of 450 Ml</p>
                <p class="price">Rs 139</p>
                <button class="addtocart">Add To Cart</button>
            </div>
            <div class="product">
                <img src="https://assets.ajio.com/medias/sys_master/root/ajio/catalog/5f15e5f27cdb8c721b7ffd6e/-1117Wx1400H-4906423980-multi-MODEL3.jpg" alt="" width="150" height="150">
                <h3 class="productname">Lifebuoy Total 10 Hand Sanitizer</h3>
                <p>Lifebuoy Total 10 Hand Sanitizer, 50 ml</p>
                <p class="price">Rs 25</p>
                <button class="addtocart">Add To Cart</button>
            </div>
            <div class="product">
                <img src="https://cdn01.pharmeasy.in/dam/products_otc/D64852/mamaearth-anti-mosquito-roll-on-pack-of-2-box-of-40-ml-2-1613381748.jpg" alt="" width="150" height="150">
                <h3 class="productname">Mamaearth Anti Mosquito Roll-on</h3>
                <p>Mamaearth Anti Mosquito Roll-on (pack Of 2) Box Of 40 Ml</p>
                <p class="price">Rs 198</p>
                <button class="addtocart">Add To Cart</button>
            </div>
            </div>
        <div class="cart-container">
            <h2>Cart</h2>
            <table>
                <thead>
                    <tr>
                        <th><strong>Product</strong></th>
                        <th><strong>Price</strong></th>
                    </tr>
                </thead>
                <tbody id="carttable">
                </tbody>
            </table>
            <hr>
            <table id="carttotals">
                <tr>
                    <td><strong>Items</strong></td>
                    <td><strong>Total</strong></td>
                </tr>
                <tr>
                    <td>x <span id="itemsquantity">0</span></td>

                    <td>Rs.<span id="total">0</span></td>
                </tr>
            </table>


            <div class="cart-buttons">
                <button id="emptycart">Empty Cart</button>
                <button id="checkout">Checkout</button>
            </div>
        </div>
    </div>
</body>
<script>
    /* get cart total from session on load */
    updateCartTotal();

    /* button event listeners */
    document.getElementById("emptycart").addEventListener("click", emptyCart);
    var btns = document.getElementsByClassName('addtocart');
    for (var i = 0; i < btns.length; i++) {
        btns[i].addEventListener('click', function() {
            addToCart(this);
        });
    }

    /* ADD TO CART functions */

    function addToCart(elem) {
        //init
        var sibs = [];
        var getprice;
        var getproductName;
        var cart = [];
        var stringCart;
        //cycles siblings for product info near the add button
        while (elem = elem.previousSibling) {
            if (elem.nodeType === 3) continue; // text node
            if (elem.className == "price") {
                getprice = elem.innerText;
            }
            if (elem.className == "productname") {
                getproductName = elem.innerText;
            }
            sibs.push(elem);
        }
        //create product object
        var product = {
            productname: getproductName,
            price: getprice
        };
        //convert product data to JSON for storage
        var stringProduct = JSON.stringify(product);
        /*send product data to session storage */

        if (!sessionStorage.getItem('cart')) {
            //append product JSON object to cart array
            cart.push(stringProduct);
            //cart to JSON
            stringCart = JSON.stringify(cart);
            //create session storage cart item
            sessionStorage.setItem('cart', stringCart);
            addedToCart(getproductName);
            updateCartTotal();
        } else {
            //get existing cart data from storage and convert back into array
            cart = JSON.parse(sessionStorage.getItem('cart'));
            //append new product JSON object
            cart.push(stringProduct);
            //cart back to JSON
            stringCart = JSON.stringify(cart);
            //overwrite cart data in sessionstorage
            sessionStorage.setItem('cart', stringCart);
            addedToCart(getproductName);
            updateCartTotal();
        }
    }
    /* Calculate Cart Total */
    function updateCartTotal() {
        //init
        var total = 0;
        var price = 0;
        var items = 0;
        var productname = "";
        var carttable = "";
        if (sessionStorage.getItem('cart')) {
            //get cart data & parse to array
            var cart = JSON.parse(sessionStorage.getItem('cart'));
            //get no of items in cart
            items = cart.length;
            //loop over cart array
            for (var i = 0; i < items; i++) {
                //convert each JSON product in array back into object
                var x = JSON.parse(cart[i]);
                //get property value of price
                price = parseFloat(x.price.split('Rs')[1]);
                productname = x.productname;
                //add price to total
                carttable += "<tr><td>" + productname + "</td><td>Rs" + price.toFixed(2) + "</td></tr>";
                total += price;
            }

        }
        //update total on website HTML
        document.getElementById("total").innerHTML = total.toFixed(2);
        //insert saved products to cart table
        document.getElementById("carttable").innerHTML = carttable;
        //update items in cart on website HTML
        document.getElementById("itemsquantity").innerHTML = items;
    }
    //user feedback on successful add
    function addedToCart(pname) {
        var message = pname + " was added to the cart";
        var alerts = document.getElementById("alerts");
        alerts.innerHTML = message;
        if (!alerts.classList.contains("message")) {
            alerts.classList.add("message");
        }
    }
    /* User Manually empty cart */
    function emptyCart() {
        //remove cart session storage object & refresh cart totals
        if (sessionStorage.getItem('cart')) {
            sessionStorage.removeItem('cart');
            updateCartTotal();
            //clear message and remove class style
            var alerts = document.getElementById("alerts");
            alerts.innerHTML = "";
            if (alerts.classList.contains("message")) {
                alerts.classList.remove("message");
            }
        }
    }
</script>

</html>
